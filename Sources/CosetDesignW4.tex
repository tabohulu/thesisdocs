\section{Coset Design for W4RTZs}
The coset interleaver with parameters $D,s_1,s_2$ carefully chosen is able to effectively deal with W2RTZs and W3RTZs. It is however unable to effectively deal with weight-$4$ RTZ inputs. The composition of all the cosets is the same and this brings about regularity characteristic in the overall interleaver. This regularity whiles desirable makes it difficult for W4RTZ to be effectively broken by the interleaver. 
%To understand how the current coset design affects W4RTZs, we need to see the inner workings of the coset as it relates to the permutation matrix.

%\subsection{Inner workings of coset design}(Working on it)
%When using $\Pi^{(0)}$, there cosecutive elements are taken from each coset one coset at a time. We can therefore further divide each coset into 3 inner cosets, placing the consecutive elements in different cosets. These inner cosets when focusing on $\bbC^{0}$ are represented by $\bbC^{0t'},~t'=\{0,1,2\}$. The elements in $\bbC^{0}$ can be written as $3(\pi(h))+0,~h=\{0,1,\cdots,L-1\}$, where $\pi(h)$ is given by (\ref{eq3}). To see how the elements are placed in $\bbC^{0t'}$, we rewrite (\ref{eq3}) as 
%\begin{equation}
%\pi(h)=D(3m+t')+\lfloor\frac{3m+t'}{A}\rfloor \bmod L,~m=\{0,1,\cdots,M-1\} \rfloor
%\end{equation}

% and the elements in $\bbC^{0t'}$ can be written as $3\Big(3j+t'\Big)+0,~j=\{0,1,\cdots,M-1\}$

\subsection{Dealing with weight-4 RTZ inputs}
To deal with weight-4 RTZ inputs we need to introduce some kind of controlled irregularity into our design of the coset interleaver. This is acheived by performing coset design at the inner coset $\bbC^{tt'}$. Lets begin by focusing on $\bbC^{0t}$. The following notations will be used.

\begin{enumerate}

\item $D_0$ is the angular shift and is the same for all $\bbC^{tt'}$ and is used as a parameter in the ALI

\item $D_1,~D_2$ represent to first element in $\bbC^{01}$ and $\bbC^{02}$ respectively.

%\item $\Pi'=\begin{bmatrix}
%	0 & 1 & 2\cr
	%\end{bmatrix}$ is the permutation matrix
\end{enumerate}

 For each element in $\bbC^{00}$ is calculated as $$c_m^{00}=D_0m+\lfloor \frac{m}{A} \rfloor \bmod M $$, where $$A=M/C,~C=gcd(M,D_0)$$.
 Elements in  $\bbC^{01}$ and $\bbC^{02}$ are calculated as follows
 $$c_m^{01}=D_0m+\lfloor \frac{m}{A} \rfloor+D_1 \bmod M $$
 and
 $$c_m^{02}=D_0m+\lfloor \frac{m}{A} \rfloor +D_2\bmod M $$
 
 With respect to $\bbC^{1t'}$ and $\bbC^{2t'}$ we have 
$$ c_m^{10}=c_m^{01},~c_m^{11}=c_m^{02},~c_m^{12}=c_m^{00}$$ and
$$ c_m^{20}=c_m^{02},~c_m^{21}=c_m^{00},~c_m^{22}=c_m^{01}$$
respectively.
To obtain the corresponding values for $\bbC^t$, we perform the simple operation shown below
 
 \begin{equation} 
 c^{t}_h=3(3c^{tt'}_{m}+t')+t
 \label{eq12}
 \end{equation} 
 where $$ m=\Big \lfloor \frac{h}{\tau} \Big \rfloor, ~t'=\bmod(m,\tau),t=0,1,...,\tau-1,~h=0,1,...,C-1$$
 
 After the index sets $\bbC^t$ have been determined, $s_1,s_2$ may be used to further adjust the start point of $\bbC^1$ and $\bbC^2$ respectively.
 The above process introduces some chaos into $\bbC^t$ which will be useful in dealing with weight-$4$ RTZ inputs. We show how to calculate the respective Hamming weights with respect to the changed design.
 
 
 \subsection{Weight-$2$ RTZ inputs Hamming Weight}
 $w_H$ for weight-$2$ RTZ inputs is easily determined. For all $\bbC^{tt'}$ the separation between each element is the same and for simplicity sake we will use $\bbC^{00}$ to rewrite \ref{eq3}
 
 we know that $$c_m^{00}=D_0m+\lfloor \frac{m}{A} \rfloor \bmod M $$
  From $\bPi^{(0)}$ we can deduce that W2RTZs in both component codes corresponds to the $m$ and $m+1$ elements being picked and the difference between the $m$th and $(m+1)$th element is either $D \bmod M$ or $M- (D \bmod M)$. In terms of the $h$th and $(h+\alpha)$th element in $\bbC^{0}, \Delta_{c'}=3\cdot\min{(D \bmod M, M- (D \bmod M))}$

 
 
 Upon substitution, our Hamming weight equation becomes
 
 \begin{equation}
 \begin{split}
w_H^{(2)}=&6+2\Big(3+\frac{3(3\cdot \min{(D \bmod M, M- (D \bmod M))})}{3}\Big)\\
=&6+2\Big(3+3\cdot\min{(D \bmod M, M- (D \bmod M))}\Big)\\
=&6+6(1+\min{(D \bmod M, M- (D \bmod M))})
\end{split}
\end{equation}

\subsection{Weight-$3$ RTZ inputs Hamming Weight}
 From the choice of $\bPi^{(0)}$, we are able to know the W3RTZs which potentially cause low-weight turbo codes. 
 %Using this knowledge (\ref{eq12}) we should be able to calculate the associated Hamming weight for the codeword produced by weight-$3$ RTZ inputs. 
 Let us represent the pre-interleaving  weight-$3$ RTZ inputs by the vector $\bn=(n_0,n_1,n_2),~\bn \in \cN$. Also $t,l,m,t'$ in (\ref{eq12}) are calculated using the following equations
 
 \begin{equation}
 \begin{split}
 &t_i=n_i \bmod 3\\
 &h_i=\Big\lfloor \frac{n_i}{3} \Big\rfloor\\
 &m_i=\Big\lfloor \frac{h_i}{3} \Big\rfloor\\
 &t'_i =h_i \bmod 3
 \end{split}
 \end{equation}

In calculating the corresponding hamming weight for the weight-$3$ RTZ we only need the $3c^{tt'}_{m}+t'$ portion of \ref{eq12} and the corresponding vector $\by$ as a result of feeding $\bn$ into it is given by
 $$\b=\Big((3c^{t_{0}t'_{0}}_{m_{0}}+t'_0,~3c^{t_{1}t'_{1}}_{m_{1}}+t'_1,~3c^{t_{2}t'_{2}}_{m_{2}}+t'_{2}) -\min(3c^{t_{0}t'_{0}}_{m_{0}}+t'_0,~3c^{t_{1}t'_{1}}_{m_{1}}+t'_1,~3c^{t_{2}t'_{2}}_{m_{2}}+t'_{2})\Big)$$
 
 and $l'=\max(\beta,\gamma)= y_{\max}$
 
 \subsection{Weight-$4$ RTZ Inputs Hamming Weight}
 $\bbN$