\documentclass[11pt, oneside, dvipdfmx]{book}
\newcommand{\folder}{/usr/local/share/texmf}
%\newcommand{\folder}{/home/hanchenggao/Documents/texmf}
\input{\folder/hfiles/ebook}
\usepackage {graphicx}
\usepackage {graphics}
%\setCJKmainfont{SimSun}
\title{``
Progress So Far'' }
\author{Kwame Ackah Bohulu}
\date{\today}
\begin{document}

\maketitle
\section{Notation}
\begin{enumerate}
\item RTZ (Return-To-Zero) input :- A RTZ input is a binary input which causes a RSC encoder's final state to be return to zero after it has exited the zero state.

\item $\tau$ :- cycle length of the RSC encoder. For the $5/7$ RSC encoder $\tau = 3$

\item $N$ :- Interleaver length. 

\item $\cN$:- Integer set of $\{0,1,\cdots,N-1\}$

\item $\bbN$: Indexed set  of $\{0,1,\cdots,N-1\}$ in the natural order.

\item We assume that $N/\tau=C$

\item $\cC$ and $\bbC$ are definded in a similar manner.

\item $\cC^{t}:=\left\{c+t\right\}_{c \in \cC}$ and $\bbC^t$ is the indexed set with the elements of $\cC^t$ where  $t=(0,1,...,\tau-1)$. Where it becomes necessary to distinguish between the elements of $\cC^{t}$ and $\bbC^{t}$, we will write the elements of $\bbC^{t}$ as $c_{x'}^{t'}$ and the elements of $\cC^{t}$ as $c_x^{t}$

\item Permutation matrix 
\begin{equation*}
\bPi = \begin{bmatrix}
\bpi^0\cr
\bpi^1\cr
\vdots\cr
\bpi^{K-1}
\end{bmatrix}
= \begin{bmatrix}
\bpi_0 , \bpi_1,\cdots,\bpi_{\tau-1}
\end{bmatrix}
= \begin{bmatrix}
\pi_{t}^{(i)}
\end{bmatrix}_{i=0,~t=0}^{K-1,~\tau -1}
\end{equation*}
where $\pi_{t}^{(i)} \in \{0,1,\tau-1\}$. 

\item For the row vector $\bpi^{(i)}$, let $\mathscr{S}^e[\bpi^{(i)}]$ be the left-hand cycle shift of $\bpi^{(i)}$ and $\mathscr{S}^e[\bpi_t]$ be the up cycle shift of $\bpi_t$
\item We assume that the operation outputs the elements in $\bbC^t$ in order while $t$ is appeared in $\bpi^k$. For example, $\bpi^0 = (0,0,1)$ outputs $(c_0^0,c_1^0,c_0^1)$. From this example, we can see that the column index of $i$ in $\pi^{(i)}$ represents the coset it belongs to before interleaving and the value $\pi_{j}^{(i)}$ specifies the coset after interleaving
\item Our goal is to find a prefer $\bPi$ and $\bbC^t$, $t = 0,1,\cdots,\tau-1$.
\end{enumerate}


\section{Cosets and RTZ inputs}

\begin{enumerate}
\item a weight $2$ input sequence
\begin{itemize}
	\item polynomial: $P(x)=x^{h\tau+t}(1+x^{\alpha \tau}) = x^t(x^{h\tau}+x^{(h+\alpha)\tau})$
	\item coset: the $h$th and $(h+\alpha)$th elements in $\bbC^t$
\end{itemize}
\item a weight $3$ input sequence
\begin{itemize}
	\item polynomial: $Q(x) =x^{h\tau+t}(1+x^{\beta \tau +1}+x^{\gamma \tau +2})=x^{h\tau+t}+x^{(h+\beta) \tau +t+1}+x^{(h+\gamma) \tau +t+2}$. 
	Notice that $h \leq \beta$ is not a necessary condition.
	\item coset: the $h$th element in $\bbC^{t}$, $(h+\beta)$th element in $\bbC^{[t+1]_\tau}$, and $(h+\gamma)$th element in $\bbC^{[t+2]_\tau}$.
\end{itemize}
\end{enumerate}

\section{Representation of interleaver}
If the mapping relationship between elements in $\bx$ and $\by$ are read column wise as shown below

$$  
 \begin{bmatrix}
0 & 1 & 2 & 3 & 4 & 5 & 6 & 7 & 8 \\
0 & 5 & 1 & 6 & 2 & 7 & 3 & 8 & 4 \\
\end{bmatrix}
$$
the interleaver is represented by $\bbN=\{0,5,1,6,2,7,3,8,4\}$.

Let $\bbC^0=\{0,6,3\}$, $\bbC^1=\{1,7,4\}$, and $\bbC^2=\{5,2,8\}$. Then, the permutation matrix of $\bbN$ is
$\bPi = (0,2,1)$. Notice the row of $\bPi$ takes cyclicly.


\section{Coset Interleaver Design For Weight-$2$ RTZ inputs}
From the definition of Weight-$2$ RTZ inputs in the previous section, we know that the index of the ``1'' bits are in the same coset. Our aim is to make sure that the interleaver that we design is either able to break such weight-$2$ RTZ inputs or convert it into a large separation weight-$2$ RTZ. 
The condition to break weight-$2$ RTZs is given as

\begin{equation}
\pi_{j}^{(i)} \neq \pi_{j}^{(i')},~|i-i'| \leq N_c
\label{eq1}
\end{equation}

Since $\bPi$ consisting of $\tau$ elements, the maximum length of column elements consisting of values different each other is $\tau$. Thus, the cut-off interleaver length for which (\ref{eq1}) is satisfied is $N_c=\tau=3$.
For this interleaver length, we investigate 3 different compositions of permutation matrices that can be used to achieve this condition in in \ref{eq1}

\begin{enumerate}
	\item One cycle permutation: Each row is permutation of the sequence $(0,1,2)$. Setting the element at the first row and first column to $0$, there are exactly 4 permutation matrices that exist for cut-off length $N_c$.
	Let
	\begin{equation*}
	\bpsi=\begin{bmatrix} 0\cr 1\cr 2\cr \end{bmatrix},~
	\bpsi'=\begin{bmatrix} 0\cr 2\cr 1\cr \end{bmatrix}
	\end{equation*}
We then have 
	\begin{equation}
	\begin{split}
	[\bpsi,\mathscr{S}^1[\bpsi],\mathscr{S}^2[\bpsi]]=
	&
	\begin{bmatrix}
	0 & 1 & 2\cr
	1 & 2 & 0\cr
	2 & 0 & 1
	\end{bmatrix}:=\bpsi(\bpsi) \\
	[\bpsi',\mathscr{S}^1[\bpsi'],\mathscr{S}^2[\bpsi']]=
	&
	\begin{bmatrix}
	0 & 1 & 2\cr
	2 & 0 & 1\cr
	1 & 2 & 0
	\end{bmatrix}:=\bpsi(\bpsi')\\
	[\bpsi,\mathscr{S}^2[\bpsi],\mathscr{S}^1[\bpsi]]=
	&
	\begin{bmatrix}
	0 & 2 & 1\cr
	2 & 1 & 0\cr
	1 & 0 & 2
	\end{bmatrix}:=\bpsi'(\bpsi)\\
	[\bpsi',\mathscr{S}^2[\bpsi'],\mathscr{S}^1[\bpsi']]=
	&
	\begin{bmatrix}
	0 & 2 & 1\cr
	1 & 0 & 2\cr
	2 & 1 & 0
	\end{bmatrix}:=\bpsi'(\bpsi')\\
	\end{split}
	\end{equation}
	
	%{\bf find all such matrices.}
	
	\item Two cycle permutation: Two rows are permutation of the sequence $(0,0,1,1,2,2)$.
	
	There are no permutation matrices that satisfying cut-off length $N_c $. This is because the sequence length is not divisible by $N_c$, there will always be 2 elements of the same value in each row of $\bPi$
	
	
	\item Three cycle permutation: Three rows are permutation of the sequence$(0,0,0,1,1,1,2,2,2)$. 
	
	Example of the permutation matrices satisfying cut-off length $N_c = 9$ are shown in \ref{tb1}
	
	
\end{enumerate}





Table \ref{tb1} shows all unique coset interleaving arrays of length $N_c$ that convert weight-$2$ RTZ inputs to non-RTZ inputs. They are labeled from $A$ to $X$. A coset interleaving array is unique if a shift of the elements in the array does not produce another another coset interleaving array.

\begin{table}[h!]
\centering
\begin{tabular}{|c || c | c|| c|c || c | c|| c|} 
 \hline
 $A$ & $ \begin{bmatrix}0 & 0 & 0\cr1 & 1 & 1\cr2 & 2 & 2\end{bmatrix}$ 
 &
  $B$ & $\begin{bmatrix} 0 & 0 & 0 \cr 1 & 1 & 2 \cr 2 & 2 & 1\end{bmatrix}$ 
  &
  $C$ &$\begin{bmatrix} 0 & 0 & 0 \cr 1 & 2 & 1 \cr 2 & 1 & 2\end{bmatrix}$
  &
  $D$ & $\begin{bmatrix}0 & 0 & 0 \cr 1 & 2 & 2 \cr 2 & 1 & 1\end{bmatrix}$\\
 \hline
  $E$ & $\begin{bmatrix}0 & 0 & 0 \cr 2 & 1 & 1 \cr 1 & 2 & 2\end{bmatrix}$ 
 &
 $F$ & $\begin{bmatrix}0 & 0 & 0 \cr 2 & 1 & 2 \cr 1 & 2 & 1\end{bmatrix}$ 
 &
  $G$ & $\begin{bmatrix}0 & 0 & 0 \cr 2 & 2 & 1 \cr 1 & 1 & 2\end{bmatrix}$ 
 &
  $H$ & $\begin{bmatrix} 0 & 0 & 0\cr 2 & 2 & 2\cr 1 & 1 & 1\end{bmatrix}$\\ 
 \hline
   $I$ & $\begin{bmatrix} 0 & 0 & 1 \cr 1 & 1 & 0 \cr 2 & 2 & 2\end{bmatrix}$
 &
  $J$ & $\begin{bmatrix}0 & 0 & 1 \cr 1 & 2 & 0 \cr 2 & 1 & 2\end{bmatrix}$ 
 &
  $K$ & $\begin{bmatrix}0 & 0 & 1 \cr 2 & 1 & 0 \cr 1 & 2 & 2 \end{bmatrix}$
 &
 $L$ & $\begin{bmatrix}0 & 0 & 1 \cr 2 & 2 & 0 \cr 1 & 1 & 2\end{bmatrix}$\\ 
 \hline
 $M$ & $\begin{bmatrix}0 & 0 & 2 \cr 1 & 1 & 0 \cr 2 & 2 & 1 \end{bmatrix}$
 &
  $N$ & $\begin{bmatrix}0 & 0 & 2 \cr 1 & 2 & 0 \cr 2 & 1 & 1 \end{bmatrix}$ 
 &
 $O$ & $\begin{bmatrix}0 & 0 & 2 \cr 2 & 1 & 0 \cr 1 & 2 & 1\end{bmatrix}$ 
&
 $P$ & $\begin{bmatrix}0 & 0 & 2 \cr 2 & 2 & 0 \cr 1 & 1 & 1\end{bmatrix}$\\ 
 \hline
 $Q$ & $\begin{bmatrix}0 & 1 & 0 \cr 1 & 0 & 1 \cr 2 & 2 & 2 \end{bmatrix}$
&
  $R$ & $\begin{bmatrix}0 & 1 & 0 \cr 1 & 0 & 2 \cr 2 & 2 & 1\end{bmatrix}$ 
&
 $S$ & $\begin{bmatrix}0 & 1 & 0 \cr 1 & 2 & 1 \cr 2 & 0 & 2 \end{bmatrix}$
 &
 $T$ & $\begin{bmatrix}0 & 1 & 0 \cr 2 & 0 & 1 \cr 1 & 2 & 2\end{bmatrix}$\\ 
 \hline
 $U$ & $\begin{bmatrix}0 & 1 & 0 \cr 2 & 0 & 2 \cr 1 & 2 & 1\end{bmatrix}$ 
 &
 $V$ & $\begin{bmatrix}0 & 1 & 0 \cr 2 & 2 & 1 \cr 1 & 0 & 2\end{bmatrix}$ 
 &
 $W$ & $\begin{bmatrix}0 & 1 & 1 \cr 1 & 2 & 0 \cr 2 & 0 & 2 \end{bmatrix}$
 &
 $X$ & $\begin{bmatrix}0 & 2 & 0 \cr 2 & 0 & 2 \cr 1 & 1 & 1\end{bmatrix}$\\ 
   \hline

  \end{tabular}
\caption{All unique coset interleaving arrays of length $N_c =9$ for weight-$2$ RTZ inputs}
\label{tb1}
\end{table}

The interleaver length used in turbo coding are way greater than $N_c$ and it is not possible to transform weight-$2$ RTZ inputs into non-RTZ inputs for all values of $i$. All is not lost however, since not all weight-$2$ RTZ inputs produce low-weight codewords. 
The formula for calculating the Hamming weight ($w_H$) of the Turbo codeword produced by a weight-$2$ RTZ input occuring in both component codes is given by[SunTakeshita] 
\begin{equation}
\begin{split}
w_H=&2+(2 + \frac{\Delta_c}{\tau} )w_0+ (2 + \frac{\Delta_{c'}}{\tau})w_0\\
=&6+\Big(\frac{\Delta_c+\Delta_{c'}}{\tau}\Big)w_0,~w_0=2
\end{split}
\label{eq3}
\end{equation}

For all the $\Pi$ in Table \ref{tb1} $\Delta_c = 9=3\tau$ and $\Delta_{c'}:=(c_{(h'+\alpha')}^{t}-c_{(h')}^{t})$ . It is convinient to write $\Delta_{c'}$ in terms of $D$ 

$$c_{(h'+\alpha')}^{t}=3*(D(h+\alpha)+ \lfloor \frac{h+\alpha}{A} \rfloor \bmod L)$$ and $$c_{(h')}^{t})=3*(D(h)+ \lfloor \frac{h}{A} \rfloor \bmod L)$$
where $A=L/C),~C=gcd(L,D)$. 
$A$ can take on $3$ different values,$L,~L/3,~3$
if $A>3$ $\Delta_{c'}$ simplifies to $$\Delta_{c'}=3*(D(\alpha) \bmod L)$$ else $$\Delta_{c'}=3*(D(\alpha) +1\bmod L)$$ 

Again due to the choice of $\Pi,~\alpha=\tau=3$, when $A>3$ we have 
\begin{equation*}
\begin{split}
w_H=&6+w_0\Big(3+\frac{3*(D(\alpha) \bmod L)}{3}\Big),~w_0=2\\
=&6+2\Big(3+(D(\alpha) \bmod L)\Big)
\end{split}
\end{equation*}

else we have 
\begin{equation*}
\begin{split}
w_H=&6+w_0\Big(3+\frac{3*(D(\alpha) +1 \bmod L)}{3}\Big),~w_0=2\\
=&6+2\Big(3+(D(\alpha)+1 \bmod L)\Big)
\end{split}
\end{equation*}

more accurately we have the following equation
\begin{equation}
w_H=
\begin{cases}
\min \Bigg (6+2\Big(3+(D(\alpha) \bmod L)\Big),~6+2\Big(3+(L-(D(\alpha) \bmod L))\Big)\Bigg), ~A>3 \\
6+2\Big(3+(D(\alpha)+1 \bmod L)\Big), ~A=3\\

\end{cases}
\label{eq9}
\end{equation}

%This means that by altering the value of $t$ and $s$, we can increase the weight of the codeword produced. With this knowledge,
%all we need to do is to make sure that the if the input to the interleaver is a weight-$2$ RTZ inputs with a small value of $t$, it is converted to a weight-$2$ RTZ with a large value of $s$

%In summary, an interleaver designed to deal with weight-$2$ RTZ inputs when $N>N_c$ should
%\begin{enumerate}
%\item Convert  weight-$2$ RTZ inputs to non-RTZ inputs

%\item Convert  weight-$2$ RTZ inputs to a weight-$2$ RTZ inputs with a large value of $s$ when condition 1 isnt possible.

%\end{enumerate}

%An interleaver design method which makes use of the above points is as follows.
%Given an interlever with length $N$, we break it up into $\frac{N}{N_c}$ blocks each of length $N_c$. At the beginning of the $n$th block, the coset interleaving pattern is repeated until the last block. By applying this method, we make sure that when the weight-$2$ RTZ occurs within a  block, condition 1 is met and condition 2 is met when the weight-$2$ RTZ occurs in 2 consecutive blocks i.e. when  $t=N_c$.

%This method only works when $N_c | N$ and we will delay the details of what to do when $N_c \not| N$.

\section{Coset Interleaver Design For Weight-$3$ RTZ inputs}
As mentioned earlier, a weight-$3$ RTZ input is formed when the indices of the ``1'' bits each occur in different cosets.  It goes without saying that the simplest way to convert a weight-$3$ RTZ input into a non-RTZ input is to make sure that at least two of indices of the ``1'' bits occur within the same coset after interleaving.
\begin{equation}
w_H=
7+2(l+l') 
\label{eq6}
\end{equation}



Unique permutation matrices which meet this criteria are shown in Table \ref{tb2} and they are labeled from $A$ to $L$

\begin{table}[h!]
\centering
\begin{tabular}{|c || c  |c  ||c  |} 
 \hline
 $A$ & $\begin{bmatrix} 0 & 0 & 0 \cr 1 & 1 & 1 \cr 2 & 2 & 2\end{bmatrix}$ 
  &
 $B$ & $\begin{bmatrix}0 & 0 & 0 \cr 1 & 1 & 2 \cr 1 & 2 & 2\end{bmatrix}$\\ 
 \hline
$C$ & $\begin{bmatrix}0 & 0 & 0 \cr 1 & 1 & 2 \cr 2 & 1 & 2\end{bmatrix}$ 
 &
$D$ & $\begin{bmatrix}0 & 0 & 0 \cr 1 & 1 & 2 \cr 2 & 2 & 1\end{bmatrix}$\\ 
 \hline
 $E$ & $\begin{bmatrix}0 & 0 & 0 \cr 2 & 2 & 1 \cr 1 & 1 & 2\end{bmatrix}$ 
 &
 $F$ & $\begin{bmatrix}0 & 0 & 0 \cr 2 & 2 & 1 \cr 1 & 2 & 1\end{bmatrix}$\\ 
 \hline
 $G$ & $\begin{bmatrix}0 & 0 & 0 \cr 2 & 2 & 1 \cr 2 & 1 & 1\end{bmatrix}$ 
 &
  $H$ & $\begin{bmatrix}0 & 0 & 1 \cr 0 & 1 & 1 \cr 2 & 2 & 2\end{bmatrix}$\\ 
 \hline
  $I$ & $\begin{bmatrix}0 & 0 & 1 \cr 1 & 1 & 2 \cr 2 & 0 & 2\end{bmatrix}$ 
 &
 $J$ & $\begin{bmatrix}0 & 0 & 2 \cr 0 & 2 & 2 \cr 1 & 1 & 1\end{bmatrix}$\\ 
 \hline
  $K$ & $\begin{bmatrix}0 & 0 & 2 \cr 2 & 2 & 1 \cr 1 & 0 & 1\end{bmatrix}$
 &
  $L$ & $\begin{bmatrix}0 & 1 & 0 \cr 1 & 1 & 2 \cr 2 & 0 & 2\end{bmatrix}$\\ 
 \hline
\end{tabular}
\caption{All unique permutation matrices of length $N_c =9$ for weight-$3$ RTZ inputs}
\label{tb2}
\end{table}

Depending on which permutation matrix is chosen from Table \ref{tb2}, Equation \ref{eq6} can be simplified. 

In general $w_H$ for turbo codewords as a result of weight-$3$ RTZ inputs can be written as $$w_H=3 + w_p+ w'_p$$, where $w_p,w'_p$ refer to the pre-interleaving parity weight and the post-interleaving parity weight respectively. The value of $w_p$ for the pre-interleaving weight-$3$ is dependent on the elements in $\cC^t$

Let $(c_{(h)}^{t},~c_{(h+\beta)}^{t+1},~c_{(h+\gamma)}^{t+2})$ be the vector representing a weight-$3$ RTZ input
%\begin{equation}
%\begin{split}
%c^{h}_{t}&=\alpha\tau+ t\\
%c^{h+\beta}_{t+1}&=(\alpha+\beta)\tau+ t+1\\
%c^{h+\gamma}_{t+2}&=(\alpha+\gamma)\tau+ t+2\\
%\end{split}
%\label{eq7}
%\end{equation}
Without loss of generality, we can assume that $h =t =0$. We then have 
\begin{equation}
l=\max{(\beta,\gamma)}
\label{eq8}
\end{equation}
And 
\begin{equation}
w_p=
2(\max{(\beta,\gamma)})+2
\label{eq9}
\end{equation}
By deciding on the $\Pi$ we can easily calculate all values of $l$ and $w_p$
$w'_p,\beta',\gamma' $ and $l'$ are similarly defined and are dependent on the elements in $\bbC^{t},~t=0,1,..,\tau-1$

As an example, Table \ref{tb3} shows all the weight-$3$ RTZ inputs and the corresponding equations for calculating $w_H$

\begin{table}
\centering
\begin{tabular}{||c |c  |c  |c |} 
 \hline
 RTZ index  & $ l$ & $w_p$& $w_H$\\
 \hline
 $(0~4~8)$ & $2$ & $6$ & $11+2(\max{(\beta',\gamma')})$\\
 \hline
 $(0~5~7)$ &  $2$ & $6$ &$11+2(\max{(\beta',\gamma')})$\\
 \hline
 $(1~3~8) $ &  $2$ & $6$ & $11+2(\max{(\beta',\gamma')})$\\
 \hline
 $(1~5~6) $ &  $1$ & $4$ & $9+2(\max{(\beta',\gamma')})$\\
 \hline
 $(2~3~7)$ & $1$ & $4$ & $9+2(\max{(\beta',\gamma')})$\\
 \hline
 $(2~4~6)$ & $1$ & $4$ & $9+2(\max{(\beta',\gamma')})$\\
 \hline\hline
  $(0~8~13)$ & $4$ & $10$ & $15+2(\max{(\beta',\gamma')})$\\
 \hline
 $(0~4~17)$ & $5$ & $12$ & $17+2(\max{(\beta',\gamma')})$\\
 \hline
 $(0~13~17)$ & $5$ & $12$ & $17+2(\max{(\beta',\gamma')})$\\
 \hline
  $(0~7~14)$ &  $4$ & $6$ &$15+2(\max{(\beta',\gamma')})$\\
 \hline
  $(0~5~16)$ &  $5$ & $6$ &$17+2(\max{(\beta',\gamma')})$\\
 \hline
  $(0~14~16)$ &  $5$ & $6$ &$17+2(\max{(\beta',\gamma')})$\\
 \hline
 $(1~8~12) $ &  $3$ & $8$ & $13+2(\max{(\beta',\gamma')})$\\
 \hline
 $(1~3~17) $ &  $5$ & $12$ & $17+2(\max{(\beta',\gamma')})$\\
 \hline
 $(1~12~17) $ & $5$ & $12$ & $17+2(\max{(\beta',\gamma')})$\\
 \hline
  $(1~6~14) $ &  $4$ & $10$ & $15+2(\max{(\beta',\gamma')})$\\
 \hline
  $(1~5~15)$ &  $4$ & $10$ & $15+2(\max{(\beta',\gamma')})$\\
 \hline
  $(1~14~15)$ &  $4$ & $10$ & $15+2(\max{(\beta',\gamma')})$\\
 \hline
 $(2~7~12)$ & $3$ & $8$ & $13+2(\max{(\beta',\gamma')})$\\
 \hline
 $(2~3~16)$ & $4$ & $10$ & $15+2(\max{(\beta',\gamma')})$\\
 \hline
 $(2~12~16)$ & $4$ & $10$ & $15+2(\max{(\beta',\gamma')})$\\
 \hline
  $(2~6~13)$ & $3$ & $8$ & $13+2(\max{(\beta',\gamma')})$\\
 \hline
  $(2~4~15)$ & $4$ & $10$ & $15+2(\max{(\beta',\gamma')})$\\
 \hline
  $(2~13~15)$ & $4$ & $10$ & $15+2(\max{(\beta',\gamma')})$\\
 \hline
\end{tabular}
\caption{All unique permutation matrices of length $N_c =9$ for weight-$3$ RTZ inputs}
\label{tb3}
\end{table}

\section{Coset Design}
Once the permutation matrix is decided upon, we have the necessary constraints which will help us design $\bbC^t$ with respect to weight $2$ and weight $3$ RTZ inputs.
We settle on $$\begin{bmatrix} 0 & 0 & 0 \cr 1 & 1 & 1 \cr 2 & 2 & 2\end{bmatrix}$$ which we will refer to as $\bPi^{(0)}$. It was decided upon because in the design process, we only need to focus on only one of the cosets, say $\bbC^0$ and replicate the results for the remaining cosets. We will make use of the Almost Linear Interleaver(ALI) is the design of $\bbC^0$. 
The interleaving equation for the ALI(L,D) Interleaver is given by $$\pi(h)=D \cdot h + \Big\lfloor \frac{h}{A} \Big\rfloor \bmod L$$ where $A=L/C,~L=N/3$ and $C=\text{gcd}(D,L)$ Also, $D$ is the period of the interleaver and h=0,1,...,L-1.

The value of a coset element at position $h$ will be $3\pi(h)$. The resulting coset interleaver will be reffered to by the notation CI(N,D)

For weight-$2$ RTZ inputs, the weight can be calculated as
$
w_H=6+\Big(3+\frac{\Delta_{c'}}{3}\Big)w_0,~w_0=2
$ 
where
$\Delta_{c'}:=(c_{(h+\alpha')}^{t}-c_{(h)}^{t}),~\alpha' =3$. 
 With respect to the ALI, $c_{(h+3)}^{t}=3(\pi(h+3))$ and $c_{(h)}^{t}=3(\pi(h))$.
 Without loss of generality, we can set $h=0$ and $\Delta_{c'}=3(\pi(3))$. therefore have 
 \begin{equation}
 \begin{split}
 w_H=&\min \Bigg\{6+2\Big(3+\frac{3(\pi(3))}{3}\Big),~6+2\Big(3+\frac{K-3(\pi(3))}{3}\Big)\Bigg\}\\
  w_H=&\min \Bigg\{6+2\Big(3+\pi(3))\Big),~6+2\Big(3+(K-\pi(3))\Big)\Bigg\}\\
 \end{split}
 \label{eq8}
 \end{equation}
 
 For weight $3$-RTZ inputs, the various equations are given in Table \ref{tb3}. The positions where a weight-$3$ inputs occur are know, but they are given with respect to the complete interleaver and need to be scaled down to a single coset. 
 Let $h,~h+\beta,~h+\gamma$ be the inputs representing where the weight-$3$ RTZ inputs occur due to $\bPi^{(0)}$. Then the scaled down versions will be $h^{(0)},~(h+\beta)^{(0)},~(h+\gamma)^{(0)}$ and are calculated using the equation
 \begin{equation}
 f(x)= x \bmod 3 + 3\Big(\Big\lfloor\frac{x}{9} \Big\rfloor\Big)
 \label{eq9}
 \end{equation}
 
 We feed $h^{(0)},~(h+\beta)^{(0)},~(h+\gamma)^{(0)}$ into the ALI and we get \begin{equation}
 \bs=(\pi(h^{(0)}),~\pi((h+\beta)^{(0)}),~\pi((h+\gamma)^{(0)}))-\min(\pi(h^{(0)}),~\pi((h+\beta)^{(0)}),~\pi((h+\gamma)^{(0)}))
 \label{eq10}
 \end{equation}
  and 
 
 \begin{equation}
 l'=\max(\beta,\gamma)= \bs_{\max}-\bs_{\min}=\bs_{\max}
 \label{eq11}
 \end{equation}
 
 Below is a summary of the steps involved in determining the Hamming weight for all weight-$3$ RTZ associated with $\Pi^{(0)}$ 
 \begin{enumerate}
 \item convert  $h,~h+\beta,~h+\gamma$ into $h^{(0)},~(h+\beta)^{(0)},~(h+\gamma)^{(0)}$ using (\ref{eq9})
 
 \item input the indices into the ALI equation to obtain $\bs using (\ref{eq10})$
 
 \item find the value of $l'$ and  Hamming weight using (\ref{eq11}) and corresponding equation in Table \ref{tb3}
 
 \item repeat above steps for all RTZ-inputs in Table \ref{tb} and their shifted versions, where each shift is a multiple of $\tau^2$
 
\item Finally, the least Hamming weight value associated with weight-$3$ RTZ inputs is selected.
 \end{enumerate}
 
 If we assume that the start position for all the cosets is the same, then the above calculations with respect to the weight-$3$ RTZ inputs are sufficient, however if we desire to adjust the start position for each coset a slight change in notation will be needed. 
 
 First off we adjust the notation for a Coset interleaver from CI$(N,D)$ to CI$(N,D,s_1,s_2)$ where $s_1,~s_2$ indicate the start position for $\bbC^1,~\bbC^2$ respectively. It is worth noting that the value of $D$ used in the ALI(L,D) is the same for all the cosets, just that $\bbC^1,~\bbC^2$ are shifted by  $s_1,~s_2$ respective positions to the right.
 
 This means that values of $h^{(0)},~(h+\beta)^{(0)},~(h+\gamma)^{(0)}$ need to be adjusted by $0,~s_1,~s_2$ respectively. This statement is made assuming that $h^{(0)},~(h+\beta)^{(0)},~(h+\gamma)^{(0)}$ are in $\bbC^0,\bbC^1,\bbC^2$ respectively.
 
  Below is a summary of the steps involved in determining the Hamming weight for all weight-$3$ RTZ associated with $\Pi^{(0)}$ when $s_1,s_2>0$
 \begin{enumerate}
 \item convert  $h,~h+\beta,~h+\gamma$ into $h^{(0)},~(h+\beta)^{(0)},~(h+\gamma)^{(0)}$ using (\ref{eq9})
 
 \item input the indices $h^{(0)},~(h+\beta)^{(0)}+s_1,~(h+\gamma)^{(0)}+s_2$
 into the ALI equation to obtain $\bs using (\ref{eq10})$
 
 \item find the value of $l'$ and  Hamming weight using (\ref{eq11}) and corresponding equation in Table \ref{tb3}
 
 \item repeat above steps for all RTZ-inputs in Table \ref{tb} and their shifted versions, where each shift is a multiple of $\tau^2$
 
\item Finally, the least Hamming weight value associated with weight-$3$ RTZ inputs is selected.
 \end{enumerate}
 



\section{Simulation Results and Discussion}
Simulations for the coset interleaver CI$(N,D,s_1,s_2)$ interleaver are done for $s_1,s_2=0$. The values for $D=\{28,29,...,35\}~,N =261$ and $$\Pi =\begin{bmatrix} 0 & 0 & 0 \cr 1 & 1 & 1 \cr 2 & 2 & 2\end{bmatrix}$$

The minimum weight for each interleaver with respect to weight-2 and weight 3 RTZs are shown in Table(\ref{tb6}) and the simulation results are shown in Figure()
\begin{table}[h!]
\centering
\begin{tabular}{||c | c|c ||} 
 \hline
D &  $w_H^{(2)}$ &$w_H^{(3)}$\\
 \hline\hline
 $28$ &$18$& $115$\\
 \hline
 $29$ & $14$ & $123$\\
 \hline
 $30$ & $18$ & $121$\\
 \hline
 $31$ & $24$ & $103$\\
 \hline
$32$ & $30$ & $89$\\
 \hline
$33$ & $36$ & $75$\\
 \hline
$34$ & $42$ & $61$\\
 \hline
$35$ & $48$ & $49$\\
 \hline\hline
\end{tabular}
\caption{Minimum Hamming weight for weight-$2$ and weight-$3$ RTZ using CI$(N,D,s_1,s_2)$, where $s_1,s_2=0$}
\label{tb4}
\end{table}
As expected, the interleaver designed with CI$(261,29)$ performs the worst, but the performance of the other interleavers does not perform as expected of the data from Table \ref{tb4}. Further examination of the simulation results reveals that even though the other interleavers have high Hamming weight related to weight-$2$ and weight-$3$ RTZ inputs, the minimum distance of the code seem to be bound at by RTZ inputs with higher weights, specifically those of weight-$4$. Specifically weight-$4$ input of the form $(1+x^{\tau}) +x^{(\tau^2)}(1+x^{\tau})$ is transformed into weight-$4$ input of the form $(1+x)+x^{\tau}(1+x)$ after interleaving. In the end, the Hamming weight as a result of these combinations is $$w_H=w_m+w_p+w_{p'}=4+8+2=14$$ where $w_m$ is the weight of the RTZ-input. 

Specifically weight-$4$ inputs of the form $(1+x^{\tau}) +x^{\tau^2}(1+x^{\tau})$ are transformed into weight-$4$ inputs of the form $(1+x)+x^3(1+x)$ after interleaving because the start index for picking the elements for all the cosets are the same and these causes somewhat well separated pre-interleaving inputs to be bunched together post-interleaving inputs. This is shown in the graph of the input output relation of any of the interleavers.

This can be remedied by making sure that the start position for the other cosets are different and this can be accomplished by shifting the elements of the cosets other than $\bbC^0$ a certain value to the left. Let $a,b$ be the factor by which the $\bbC^1$ and $\bbC^2$ are shifted.  We proceed to re-design  CI$(23,0,0)$  by introducing $s_1=30$ and $s_2=7$.
The simulation results for CI$(261,23,0,0)$ and CI$(261,23,30,7)$ are shown in Figure() as can be seen adjusting the start position of the other cosets, the error-correcting performance is greatly improved. A further investigation of the simulation results reveals that for CI$(261,23,30,7)$, the Hamming distance for the turbo code is again bounded by weight-$4$ RTZ inputs. A specific example is that the weight-$4$ input of the form $(1+x^{\tau})+(x^{155})(1+x^{\tau})$ is transformed into another weight-$4$ RTZ input of the form$ (1+x^{\tau})+(x^{244})(1+x^{\tau})$. Then $$w_H=w_m+w_p+w_{p'}=4+8+8=20$$. The multiplicity of such weight-$4$ RTZ inputs is extremely high. 

\section{Weight-4 RTZ inputs}
The coset interleaver with parameters $D,s_1,s_2$ carefully chosen is able to effectively deal with weight-$2$ and weight-$3$ RTZ inputs. It is however unable to effectively deal with weight-$4$ RTZ inputs. The formation of weight-4 RTZ inputs is explained using Figure()
The chosen coset pattern ensured that weight-$2$ RTZ of the form $1+x^{t\tau},~t=1,2$ would be mapped such that the i bits were mapped to different cosets. The combination of 2 such mappings gives rise to a weight-$4$ RTZ input. The pairs that are close together produce a large hamming weight and are not problematic. However, depending on the value of $D$ chosen, there is a distance $z$between the coset pairs is $\tau$ ie a weight-$4$ RTZ input of the form $(1+x^3) +x^z(1+x^3)$

This characteristic is very similar to that of linear interleavers which are also unable to effectively deal with weight-4 RTZ inputs. in [New Deterministic Interleaver Designs for
Turbo Codes] weight-4 RTZ inputs of the form $(1+x^t)x^q + (1+x^t)x^{q+\tau}$ produce another weight-4 RTZ after interleaving, where $t$ is obtained by solving the congruence equation $tD\equiv \tau \bmod N$

\subsection{Dealing with weight-4 RTZ inputs}
To deal with weight-4 RTZ inputs we need to introduce some kind of controlled irregularity into our design of the coset interleaver. This is acheived by dividing each coset $\bbC^t$ further into $\tau $ cosets and apllying a little bit of manipulation as will be explained below. The following notations will be used.

\begin{enumerate}
\item $\bbC^{tt'},~t'=0,1,..\tau-1$ be the index set of the index set $\bbC^t$. The
 elements are written as $c^{tt'}_m,~m=0,1,...,M-1$

\item $\bbC^{tt'}$ has size $M=L/\tau$

\item $D_0$ is the angular shift and is the same for all $\bbC^{tt}$ and is used as a parameter in the ALI

\item $D_1,~D_2$ represent to first element in $\bbC^{t1}$ and $\bbC^{t2}$ respectively.

%\item $\Pi'=\begin{bmatrix}
%	0 & 1 & 2\cr
	%\end{bmatrix}$ is the permutation matrix
\end{enumerate}
Lets begin by focusing on $\bbC^{0t}$
 For each element in $\bbC^{00}$ is calculated as $$c_m^{00}=D_0m+\lfloor \frac{m}{A} \rfloor \bmod M $$, where $$A=M/C,~C=gcd(M,D_0)$$.
 Elements in  $\bbC^{01}$ and $\bbC^{02}$ are calculated as follows
 $$c_m^{01}=D_0m+\lfloor \frac{m}{A} \rfloor+D_1 \bmod M $$
 and
 $$c_m^{02}=D_0m+\lfloor \frac{m}{A} \rfloor +D_2\bmod M $$
 
 With respect to $\bbC^{1t'}$ and $\bbC^{2t'}$ we have 
$$ c_m^{10}=c_m^{01},~c_m^{11}=c_m^{02},~c_m^{12}=c_m^{02}$$ and
$$ c_m^{20}=c_m^{02},~c_m^{21}=c_m^{00},~c_m^{22}=c_m^{01}$$
respectively.
To obtain the corresponding values for $\bbC^t$, we perform the simple operation shown below
 
 \begin{equation} 
 c^{t}_l=3(3c^{tt'}_{m}+t')+t
 \label{eq12}
 \end{equation} 
 where $$ m=\Big \lfloor \frac{l}{\tau} \Big \rfloor, ~t'=\bmod(l,\tau),t=0,1,...,\tau-1,~l=0,1,...,L-1$$
 
 After the index sets $\bbC^t$ have been determined, $s_1,s_2$ may be used to further adjust the start point of $\bbC^1$ and $\bbC^2$ respectively.
 The above process introduces some chaos into $\bbC^t$ which will be useful in dealing with weight-$4$ RTZ inputs. The problem now is how to select the parameters $D_1,~D_2,~D_3,s_1,s_2$
 
 \subsection{Weight-$2$ RTZ inputs Hamming Weight}
 $w_H$ for weight-$2$ RTZ inputs is easily determined. 
 We know that for weight-$2$ RTZ inputs $$
w_H=6+2\Big(3+\frac{\Delta_{c'}}{3}\Big)
$$
where
$\Delta_{c'}:=(c_{(l+\alpha')}^{t}-c_{(l)}^{t}),~\alpha' =3$. 

 Using  (\ref{eq12}) we can determine the  value of$\Delta_{c'}$ Without loss of generality, we set $l=0$ and we have  
 $$c_{(l)}^{t}=3(3c^{tt'}_{0}+t')+t$$
 
 $$c_{(l+3)}^{t}=3(3c^{tt'}_{1}+t')+t$$
 
 \begin{equation}
 \begin{split}
 \Delta_{c'}=& 3(3c^{tt'}_{1}+t')+t-(3(3c^{tt'}_{0}+t')+t)\\
 =&9c^{tt'}_{1}+3t'+t-(9c^{tt'}_{0}+3t'+t)\\
 =&9(c^{tt'}_{1}-c^{tt'}_{0})\\
 =&9D_1
 \end{split}
 \end{equation}
 
 Upon substitution, our Hamming weight equation becomes
 
 \begin{equation}
 \begin{split}
w_H=&6+2\Big(3+\frac{9D_1}{3}\Big)\\
=&6+2\Big(3+3D_1\Big)\\
=&6+6(1+D_1)
\end{split}
\end{equation}

\subsection{Weight-$3$ RTZ inputs Hamming Weight}
 The choice of $\Pi$, we are able to know exactly which pre-interleaving weight-$3$ inputs will generate post-interleaved weight-$3$ RTZ inputs. Using this knowledge (\ref{eq12}) we should be able to calculate the associated hamming weight for the codeword produced by weight-$3$ RTZ inputs. Let us represent the pre-interleaving  weight-$3$ RTZ inputs by the vector $\bx=(x_0,x_1,x_2)$


 \end{document}